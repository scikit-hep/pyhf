# test matrix
dist: xenial
language: python
cache: pip
python:
  - '2.7'
before_install:
  - sudo apt-get install libtcmalloc-minimal4
  - export LD_PRELOAD="/usr/lib/libtcmalloc_minimal.so.4"
  - pip install --upgrade pip setuptools wheel
install:
  - pip install --ignore-installed -U -q --no-cache-dir -e .[complete];
  - pip freeze
script:
  - pyflakes src
  - check-manifest || travis_terminate 1
  - python -m pytest -r sx --ignore tests/benchmarks/ --ignore tests/test_notebooks.py
after_success: skip

# test Python 2.7 on 'push' builds
stages:
  - name: test
    if: NOT (type IN (pull_request))
